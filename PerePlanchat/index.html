<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Le jeu du P√®re Planchat</title>
    <!-- Chargement de Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* D√©finition de la police Inter */
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #e0f2fe; /* Bleu tr√®s clair */
        }
        /* Style des cases du jeu */
        .game-spot {
            width: 80px;
            height: 80px;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #a78bfa; /* Violet clair */
            border-radius: 12px; /* Coins arrondis */
            cursor: pointer;
            transition: transform 0.2s, background-color 0.2s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            font-size: 2.5rem; /* Taille de l'emoji */
            user-select: none; /* Emp√™che la s√©lection de texte */
            overflow: hidden; /* Cache le contenu qui d√©passe */
        }
        .game-spot:hover {
            transform: translateY(-3px); /* Effet de l√©ger soul√®vement au survol */
            background-color: #8b5cf6; /* Violet l√©g√®rement plus fonc√© */
        }
        .game-spot.found {
            background-color: #4ade80; /* Vert pour la case trouv√©e */
            pointer-events: none; /* D√©sactive les clics apr√®s avoir trouver */
        }
        .game-spot.clicked {
            background-color: #fca5a5; /* Rouge clair pour les cases cliqu√©es non trouv√©es */
        }
        .game-spot.game-over {
            background-color: #ef4444; /* Rouge pour la d√©faite */
            pointer-events: none;
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen bg-blue-100 p-4">

    <!-- Conteneur principal du jeu -->
    <div class="bg-white p-8 rounded-2xl shadow-xl max-w-lg w-full text-center">
        <h1 class="text-4xl font-bold text-gray-800 mb-6">Le jeu du P√®re Planchat</h1>

        <!-- Zone de message du jeu -->
        <p id="message" class="text-lg text-gray-700 mb-4">Retrouve la croix et la banni√®re en un minimum de coups, sans tomber sur des communards</p>
        <p id="moves-counter" class="text-xl font-semibold text-gray-700 mb-6">Coups: 0</p>

        <!-- Grille de jeu -->
        <div id="game-grid" class="grid grid-cols-3 md:grid-cols-3 gap-4 justify-items-center mb-6">
            <!-- Les cases du jeu seront g√©n√©r√©es ici par JavaScript -->
        </div>

        <!-- Bouton de r√©initialisation -->
        <button id="reset-button" class="bg-gradient-to-r from-purple-500 to-indigo-600 text-white font-bold py-3 px-6 rounded-xl hover:from-purple-600 hover:to-indigo-700 transition duration-300 ease-in-out shadow-lg">
            Recommencer
        </button>
    </div>

    <script>
        // Variables globales
        const gameGrid = document.getElementById('game-grid');
        const messageDisplay = document.getElementById('message');
        const movesCounter = document.getElementById('moves-counter');
        const resetButton = document.getElementById('reset-button');
        const numSpots = 9; // Nombre de cases dans la grille
        let crossLocation = -1; // Emplacement de la croix
        let bannerLocation = -1; // Emplacement de la banni√®re
        let communardLocation = -1; // Emplacement du communard
        let foundCross = false; // Indicateur si la croix est trouv√©e
        let foundBanner = false; // Indicateur si la banni√®re est trouv√©e
        let gameActive = true; // √âtat du jeu
        let moves = 0; // Nombre de coups

        // Fonction pour obtenir trois emplacements al√©atoires distincts
        function getRandomDistinctLocations(max) {
            let locs = [];
            while (locs.length < 3) {
                let r = Math.floor(Math.random() * max);
                if (locs.indexOf(r) === -1) {
                    locs.push(r);
                }
            }
            return locs;
        }

        // Fonction pour initialiser le jeu
        function initializeGame() {
            // Efface le contenu pr√©c√©dent de la grille
            gameGrid.innerHTML = '';
            // R√©initialise les messages et les compteurs
            messageDisplay.textContent = 'Retrouve la croix et la banni√®re en un minimum de coups, sans tomber sur des communards';
            moves = 0;
            movesCounter.textContent = `Coups: ${moves}`;
            // R√©initialise les indicateurs
            foundCross = false;
            foundBanner = false;
            // Active le jeu
            gameActive = true;

            // D√©termine trois emplacements al√©atoires distincts pour la croix, la banni√®re et le communard
            const [loc1, loc2, loc3] = getRandomDistinctLocations(numSpots);
            crossLocation = loc1;
            bannerLocation = loc2;
            communardLocation = loc3;

            // console.log("La croix est √† l'emplacement:", crossLocation); // Pour le d√©bogage
            // console.log("La banni√®re est √† l'emplacement:", bannerLocation); // Pour le d√©bogage
            // console.log("Le communard est √† l'emplacement:", communardLocation); // Pour le d√©bogage

            // Cr√©e les cases du jeu
            for (let i = 0; i < numSpots; i++) {
                const spot = document.createElement('div');
                spot.classList.add('game-spot', 'flex-shrink-0');
                spot.dataset.index = i;

                // Ajoute un √©couteur d'√©v√©nements pour le clic
                spot.addEventListener('click', handleSpotClick);
                gameGrid.appendChild(spot);
            }
        }

        // Fonction pour g√©rer le clic sur une case
        function handleSpotClick(event) {
            // V√©rifie si le jeu est actif
            if (!gameActive) {
                return;
            }

            const clickedSpot = event.target;
            const clickedIndex = parseInt(clickedSpot.dataset.index);

            // Si la case n'a pas d√©j√† √©t√© cliqu√©e ou trouv√©e
            if (!clickedSpot.classList.contains('clicked') && !clickedSpot.classList.contains('found') && !clickedSpot.classList.contains('game-over')) {
                moves++; // Incr√©mente le compteur de coups
                movesCounter.textContent = `Coups: ${moves}`; // Met √† jour l'affichage des coups

                // V√©rifie si c'est le communard (condition de d√©faite)
                if (clickedIndex === communardLocation) {
                    clickedSpot.textContent = '‚ò≠'; // Affiche la faucille et le marteau
                    clickedSpot.classList.add('game-over');
                    messageDisplay.textContent = 'Oh non ! Vous avez trouv√© le communard ! Partie termin√©e. üíÄ';
                    gameActive = false; // D√©sactive le jeu
                    // R√©v√®le tous les √©l√©ments pour montrer o√π ils √©taient
                    revealAllElements();
                }
                // V√©rifie si c'est la croix
                else if (clickedIndex === crossLocation && !foundCross) {
                    clickedSpot.textContent = '‚úùÔ∏è'; // Affiche l'emoji croix
                    clickedSpot.classList.add('found');
                    foundCross = true;
                }
                // V√©rifie si c'est la banni√®re
                else if (clickedIndex === bannerLocation && !foundBanner) {
                    clickedSpot.textContent = 'üè≥Ô∏è'; // Affiche l'emoji banni√®re
                    clickedSpot.classList.add('found');
                    foundBanner = true;
                }
                // Si la case ne contient ni la croix, ni la banni√®re, ni le communard
                else {
                    clickedSpot.textContent = '‚ùå'; // Affiche une croix
                    clickedSpot.classList.add('clicked');
                }

                // Met √† jour le message et v√©rifie la condition de victoire
                if (gameActive) { // Seulement si le jeu n'est pas d√©j√† termin√© par le communard
                    if (foundCross && foundBanner) {
                        messageDisplay.textContent = `F√©licitations ! Vous avez trouv√© la croix et la banni√®re en ${moves} coups ! üéâ`;
                        gameActive = false; // D√©sactive le jeu
                        revealAllElements(); // R√©v√®le les √©l√©ments restants (si le communard n'a pas √©t√© cliqu√©)
                    } else if (foundCross || foundBanner) {
                        messageDisplay.textContent = 'Bien jou√© ! Trouvez l\'autre √©l√©ment !';
                    } else {
                        messageDisplay.textContent = 'Pas ici... Essayez encore !';
                    }
                }
            }
        }

        // Fonction pour r√©v√©ler tous les √©l√©ments √† la fin de la partie (victoire ou d√©faite)
        function revealAllElements() {
            Array.from(gameGrid.children).forEach(spot => {
                const index = parseInt(spot.dataset.index);
                spot.removeEventListener('click', handleSpotClick); // D√©sactive les clics
                if (index === crossLocation && !spot.classList.contains('found')) {
                    spot.textContent = '‚úùÔ∏è';
                    spot.classList.add('found');
                } else if (index === bannerLocation && !spot.classList.contains('found')) {
                    spot.textContent = 'üè≥Ô∏è';
                    spot.classList.add('found');
                } else if (index === communardLocation && !spot.classList.contains('game-over')) {
                    spot.textContent = '‚ò≠';
                    spot.classList.add('game-over');
                }
                // Si la case a √©t√© cliqu√©e mais ne contenait rien d'important, elle reste en "X"
            });
        }

        // Ajoute un √©couteur d'√©v√©nements pour le bouton de r√©initialisation
        resetButton.addEventListener('click', initializeGame);

        // Initialise le jeu au chargement de la page
        window.onload = initializeGame;
    </script>
</body>
</html>
